# SMTP

---

**SMTP란 SSMS에서 제공해주는 이메일 전송 기능을 위한 설정 방식이다.**

- SSMS(SQL Server Management Studio)는 SQL Server의 관리 도구로, **SQL Server Agent를 통해 SMTP를 이용한 이메일 알림 기능을 제공**한다.
- 이 기능은 주로 **작업(Job) 실패, 경고, 백업 완료 등의 이벤트 발생 시 관리자에게 이메일로 알림을 보내기 위해 사용**된다.
- SMTP(Simple Mail Transfer Protocol)는 **이메일을 전송하는 표준 프로토콜**로, SSMS에서는 이를 설정하여 SQL Server가 외부 메일 서버를 통해 이메일을 보낼 수 있게 한다.

---

**SMTP 설정은 SSMS에서 다음과 같은 방식으로 구성된다:**

- **데이터베이스 메일(Database Mail)** 기능을 통해 SMTP 서버 정보, 포트, 인증 방식 등을 설정
- **SQL Server Agent의 알림(Notification)** 기능과 연동하여 특정 이벤트 발생 시 이메일 전송
- **메일 프로파일과 계정**을 생성하여 다양한 작업에 활용 가능

---

# 에이전트(SQL Server Agent)
---

**SQL Server Agent란 SSMS에서 제공해주는 자동화된 작업 관리 도구이다.**

- SQL Server Agent는 **SQL Server의 백그라운드 서비스**로, **정기적인 작업(Job), 경고(Alert), 알림(Notification)** 등을 자동으로 실행하고 관리할 수 있게 해준다.
- SSMS를 통해 설정하며, **데이터베이스 유지보수, 백업, 모니터링, 이메일 알림 등 다양한 작업을 예약 실행**할 수 있다.

---

**SQL Server Agent의 주요 기능:**

- **작업(Job):** SQL 쿼리, 저장 프로시저, SSIS 패키지 등을 특정 시간에 자동 실행
- **스케줄(Schedule):** 작업을 실행할 시간과 주기를 설정
- **알림(Notification):** 작업 실패나 경고 발생 시 이메일 등으로 관리자에게 알림 전송 (SMTP 설정 필요)
- **오퍼레이터(Operator):** 알림을 받을 대상(관리자)을 지정

---

요약하면:

> **SQL Server Agent는 SSMS에서 제공해주는 자동화된 작업 스케줄링 및 알림 시스템이다.**

---

# Gmail로 SMTP 설정하기

1. 구글 로그인
2. 계정 접속
3. 보안 -> 2단계 인증 설정 (*전화번호)
4. **앱 비밀번호 생성 : 이후 SSMS 기본인증에서 사용**

# SSMS SMTP 설정하기

1. 관리 -> 데이터베이스 메일 우클릭 -> 데이터베이스 메일 구성 -> 새 프로필 추가
2. **새 프로필 추가** : '다음 테스크를 수행하여, 데이터 베이스 메일 설치 선택' -> 프로필 이름 입력 -> 추가 -> 새 계정 클릭
3. **새 계정 클릭** : 계정이름(사용자), 전자메일주소(gmail주소), 표시이름(메일 발송 시, 메일 제목), 회신전자메일(gmail주소), 서버이름(기본값 : smtp.gmail.com), 포트 번호(기본값 : 587), **이 서버에는 보안연결이 필요합니다 체크**, 기본인증 -> 사용자 이름(gmail주소), 암호(앱 비밀번호) -> 확인

# SQL Server Agent 설정하기

1. SQL Server Agent 우클릭 -> 새로 만들기 -> 작업
2. 일반 -> 이름(에이전트 이름) -> 소유자(db id)
3. 단계 -> 새로 만들기 클릭 -> 단계 이름(단계 이름) -> 유형(사용자 지정, 현재 기본값 사용) -> 데이터베이스(DB선택) -> 명령(사용자 지정, 현재 스크립트 사용)
4. 일정 -> 새로만들기 클릭 -> 이름(작업 일정 이름) -> 일정 유형, 되풀이, 매, 열혈빈도, 기간 설정 후 확인
5. 확인